# Cell-centered Lagrange DG Code

***

## &nbsp; config.h

**定义一些整个程序都要使用的参数和函数。**

+ 计算问题的参数
  + 网格划分的大小n, m
  + 计算区域x, y
  + 空间步长$h_x, h_y$
  + 终止时间T
  + 声明时间步长dt
  + 流体的比热容$\gamma$
  + EOS
+ 程序设定
  + 网格、节点结构体定义
    + 包含几何信息和部分物理量
    + 物理网格和参考网格看作同一个网格结构体，即参考单元的几何信息也定义在其中
+ 数学求解工具
  + [Gauss求积](https://www.cnblogs.com/sunzhenwei/p/10848686.html)+Gauss节点
  + 形函数，用于确定从参考单元到物理网格的映射
  + 两点间长度计算、外法向量计算（注意定向）

**网格作为结构体应包含：**

+ 序号（一维、二维）（注明转换方式）
+ 顶点（按一定顺序）
+ 质心的参考坐标
+ 基函数[（结构体中定义函数）](https://blog.csdn.net/weixin_45525272/article/details/106446669)
+ 相邻单元
+ Jacobi矩阵
+ 质量矩阵
+ 顶点物理坐标（便于计算Jacobi，因为Jacobi被封装了）

**节点作为结构体应包含：**

+ 序号（一维、二维，注明转换方式）
+ 物理坐标
+ 节点速度
+ 相邻单元
+ 相邻节点（及相关的用于计算节点速度的边长、外法向量？）
+ 是否是边界节点

***

## &nbsp; initial.h

**定义一些初始化的函数，包括网格初始化和初边值条件。**

### 参数

+ 各种变量声明  ***可以放到config中去***
  + 网格向量、节点向量
  + 速度、质量总能(centered)（需要两个数组保存两个时间层的值）
  + 一些暂时用到的变量，例如
    + 边长？外法向量？（这些怎么保存？）（***不用保存整条边的边长，只用保存每个节点区间相应的边长，外法向量同样***）
    + 节点速度？（能否直接定义到结构体中？）
    + 密度？（这里只代表$t_n$时刻的点值，用初始条件和Jacobi矩阵得到，初值条件保存成函数）（***密度在每个Gauss节点和网格节点都需要被计算***）

### 函数

+ 网格、节点初始化
  + 记录网格和节点编号（一维编号和二维参考编号$(i,j)$）
  + 记录节点物理坐标$(x,y)$
  + 记录网格的顶点（按照某种顺序）
  + 记录节点的相邻网格（按照某种顺序）
+ 初值条件
+ 计算质心
+ 计算每个单元的质量矩阵（每个单元质量矩阵不同，需要每个都保存在结构体中）
+ 计算程序初始化
  + 网格、节点初始化
  + Jacobi
  + 质心、质量矩阵
  + 基函数

***

## &nbsp; nodal_solver.h

**节点求解器，用来求解节点速度和角落应力。**

+ 节点速度
  + 激波方向识别
  + 计算
+ corner force

***

## &nbsp; time_evolution.h

**总体的时间推进，更新密度、质量总能、单元速度、节点物理坐标。其中密度通过强质量守恒计算，其他的通过二步二阶RK计算。**

+ 密度计算，强质量守恒
+ RK方程系数矩阵计算($ \frac{dU^{(n+1)}}{dt} = L U^{(n)}$中的$L$)
+ RK step1
+ RK step2
+ 时间步长的选取

***

## &nbsp; limiter.h

**对标量和向量的限制器、对时间步长的限制。**

+ 对每个网格计算周围网格的最大均值（因为对每个网格使用limiter时都要用一次，所以保存成变量）
+ limiter

***limiter的作用是修改参与右端矩阵计算的值，在计算右端矩阵时使用***

***

## &nbsp; plot.h

**对结果画图。**

***

## &nbsp; main

```flow
st=>start: Start
e=>end
initial=>operation: Initialization
end_time=>condition: t >=T?
EOS=>operation: EOS
limiter=>operation: limiter
RK=>operation: RK
ns=>operation: nodal solver

st->initial->EOS->limiter->ns->RK->end_time
end_time(yes)->e
end_time(no)->EOS
```
